# Журнал использования ИИ в проекте "Личный кабинет клиента по экологии"

Этот документ в хронологическом порядке описывает вклад ИИ в разработку проекта.

### Этап 1: Создание структуры проекта (Backend и Frontend)

ИИ проанализировал запрос на создание базовой структуры проекта. В ТЗ (`Тестовое задание.docx.pdf`) изначально предлагался Yii2, но по текущему запросу стек обновлен на **.NET 9 (Backend)** и **Angular 20 (Frontend)**.

**Действия ИИ:**

- Сформировал набор CLI-команд для быстрой инициализации "пустых", но структурно верных проектов для выбранного стека.

**Предложенные изменения/артефакты:**

- **Backend (.NET 9):**

  - `dotnet new sln -n EcologyLK` (Создает "solution" файл, который объединит все проекты .NET)

  - `dotnet new webapi -n EcologyLK.Api -f net9.0` (Создает основной проект Web API)

  - `dotnet sln add EcologyLK.Api` (Добавляет проект API в solution)

- **Frontend (Angular 20):**

  - `npm install -g @angular/cli` (Установка Angular CLI, если отсутствует)

  - `ng new EcologyLK.Client --routing --style=scss` (Создает новое приложение Angular с файлами маршрутизации и SCSS для стилей)

  - **Архитектура:** По умолчанию используется стандартный рендеринг на стороне клиента (CSR). Рендеринг на стороне сервера (SSR) **не используется**, так как приложение является закрытым личным кабинетом, не требующим публичной индексации (SEO).

  - **Change Detection:** Будет использоваться стандартная стратегия `zone.js`. `Zoneless`-архитектура (на чистых signals) **не используется**, так как для MVP-проекта (личный кабинет) стандартный `zone.js` обеспечивает необходимую стабильность и простоту разработки.

**Предложение ИИ для следующего этага:**

1. Настроить базовое взаимодействие между проектами: сконфигурировать **CORS (Cross-Origin Resource Sharing)** в проекте `.NET (EcologyLK.Api)`, чтобы Angular-приложение (`EcologyLK.Client`) могло безопасно отправлять запросы к API.

2. Начать проектирование моделей данных и контекста базы данных (DB Context) в .NET-проекте, основываясь на анализе ТЗ (Пользователи, Клиенты, Объекты, Требования).

### Этап 2: Настройка CORS, Identity и создание базовых моделей данных (Core Data Models) с DbContext

### **Действия ИИ:**

- Проанализировав предложение из Этапа 1, ТЗ и текущий код (`CombinedCodeFiles.txt`), ИИ подтвердил, что в `EcologyLK.Api` отсутствуют:

1. Политика CORS для связи с Angular-клиентом.
2. Какие-либо модели данных.
3. Контекст базы данных (DbContext) и система аутентификации (Identity).

- **Действие 1 (CORS):** ИИ сконфигурировал базовую политику CORS в `Program.cs`, разрешающую запросы от Angular-приложения (работающего на `http://localhost:4200`).
- **Действие 2 (Пакеты EF Core & Identity):** ИИ добавил в `EcologyLK.Api.csproj` необходимые пакеты NuGet для Entity Framework Core (для работы с данными) и ASP.NET Identity (для управления пользователями и ролями, что является требованием ТЗ). Для MVP будет использоваться `InMemoryDatabase`, чтобы ускорить разработку без настройки полноценного SQL Server.
- **Действие 3 (Модели данных):** ИИ спроектировал и создал C#-классы (POCOs) для ключевых сущностей, описанных в ТЗ: `AppUser` (пользователь системы), `Client` (клиент-юрлицо), `ClientSite` (площадка клиента, ключевая сущность с параметрами НВОС), `EcologicalRequirement` (экологическое требование из "Карты требований") и `Artifact` (артефакт/документ). Также созданы `enum` для типизации параметров.
- **Действие 4 (DbContext):** ИИ создал `AppDbContext`, унаследованный от `IdentityDbContext`, который регистрирует все новые модели данных и настраивает их связи (например, "один Client ко многим ClientSites").
- **Действие 5 (Регистрация сервисов):** ИИ зарегистрировал `DbContext` и `Identity` в контейнере сервисов (`Program.cs`).

**Предложенные изменения/артефакты:**

- **Файл (Изменен):** `EcologyLK.Api/EcologyLK.Api.csproj` (добавлены пакеты EF Core и Identity)
- **Файл (Изменен):** `EcologyLK.Api/Program.cs` (Настройка CORS, DbContext и Identity)
- **Файл (Новый):** `EcologyLK.Api/Models/Enums.cs`
- **Файл (Новый):** `EcologyLK.Api/Models/AppUser.cs`
- **Файл (Новый):** `EcologyLK.Api/Models/Client.cs`
- **Файл (Новый):** `EcologyLK.Api/Models/ClientSite.cs`
- **Файл (Новый):** `EcologyLK.Api/Models/EcologicalRequirement.cs`
- **Файл (Новый):** `EcologyLK.Api/Models/Artifact.cs`
- **Файл (Новый):** `EcologyLK.Api/Data/AppDbContext.cs`

**Предложение ИИ для следующего этага:**

1. Создать первый API-контроллер (`ClientSitesController`) с методами для создания `ClientSite` (DTO "Анкеты") и получения `ClientSite` с его "Картой требований" (`EcologicalRequirements`).
2. Создать "Сервис генерации требований" (`RequirementGenerationService`), который будет вызываться при создании `ClientSite`. Этот сервис реализует бизнес-логику из файла `Критерии_для_формирования_требований_.docx.pdf` (создает нужные `EcologicalRequirement` в зависимости от `NvosCategory`, `WaterUseType` и `HasByproducts`).
3. Начать создание UI в Angular: создать `ClientSiteService` для запросов к API и компонент "Анкеты" (`client-site-form.component.ts`) для создания новой площадки.
